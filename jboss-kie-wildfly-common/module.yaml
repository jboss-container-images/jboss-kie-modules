schema_version: 1
name: jboss-kie-wildfly-common
version: "1.0"
description: The jboss-kie-wildfly-common module.
execute:
  - script: configure.sh
envs:
  - name: "AUTH_LDAP_BASE_CTX_DN"
    description: "The fixed DN of the top-level context to begin the user search."
    example: "ou=users,ou=example,ou=com"
  - name: "AUTH_LDAP_BASE_FILTER"
    description: "A search filter used to locate the context of the user to authenticate. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. A common example for the search filter is (uid={0})."
    example: "(uid={0})"
  - name: "AUTH_LDAP_RECURSIVE_SEARCH"
    description: "Indicates if the user queries are recursive."
    example: "true"
  - name: "AUTH_LDAP_BIND_CREDENTIAL"
    description: "Used to store the credentials for the DN. "
    example: "Passw0rd"
  - name: "AUTH_LDAP_BIND_DN"
    description: "The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the baseCtxDN and rolesCtxDN values."
    example: "uid=admin,ou=users,ou=exmample,ou=com"
  - name: "AUTH_LDAP_ALLOW_EMPTY_PASSWORDS"
    description: "Does this realm support blank password direct verification? Blank password attempt will be rejected otherwise. Boolean flag, defaults to false."
    example: "true"
  - name: "AUTH_LDAP_DIRECT_VERIFICATION"
    description: "Does this realm support verification of credentials by directly connecting to LDAP as the account being authenticated? Boolean flag, defaults to false."
    example: "true"
  - name: "AUTH_LDAP_DEFAULT_ROLE"
    description: "A role included for all authenticated users, when set, AUTH_LDAP_MAPPER_KEEP_NON_MAPPED is set to true as well."
    example: "user"
  - name: "AUTH_LDAP_NEW_IDENTITY_ATTRIBUTES"
    description: "Provide new identities for Ldap  identity mapping, the pattern to be used with this env is 'attribute_name=attribute_value;another_attribute_name=value'"
    example: "sn=BlankSurname;cn=BlankCommonName"
  - name: "AUTH_LDAP_DISTINGUISHED_NAME_ATTRIBUTE"
    description: "The name of the attribute in the user entry that contains the DN of the user. This may be necessary if the DN of the user itself contains special characters, backslash for example, that prevent correct user mapping. If the attribute does not exist, the entryâ€™s DN is used."
    example: "distinguishedName"
  - name: "AUTH_LDAP_MAPPER_KEEP_MAPPED"
    description: "When set to 'true' the mapped roles will retain all roles, that have defined mappings. Defaults to false. Affects default role and role mapper properties."
    example: "true"
  - name: "AUTH_LDAP_MAPPER_KEEP_NON_MAPPED"
    description: "When set to 'true' the mapped roles will retain all roles, that have no defined mappings. Affects default role and role mapper properties."
    example: "true"
  - name: "AUTH_ROLE_MAPPER_ROLES_PROPERTIES"
    description: "When present, the RoleMapping will be configured to use the provided properties file or roles. This parameter defines the fully-qualified file path and name of a properties file or a set of roles with the following pattern 'role=role1;another-role=role2'. The format of every entry in the file is original_role=role1,role2,role3. If you want to keep the role that is used to map other roles, e.g. to keep the role1 form this mapping: role1=roles2, set the AUTH_LDAP_MAPPER_KEEP_MAPPED environment variable to 'true'. If you want to keep the non mapped roles from LDAP as well, set the AUTH_LDAP_MAPPER_KEEP_NON_MAPPED environment variable to 'true'. "
    example: "role=role1,role3,role4;role7=role,admin"
  - name: "AUTH_LDAP_REFERRAL_MODE"
    description: "If LDAP referrals should be followed. Corresponds to REFERRAL ('java.naming.referral') environment property. Allowed values: 'ignore', 'follow', 'throw'"
  - name: "AUTH_LDAP_ROLE_ATTRIBUTE_ID"
    description: "Name of the attribute containing the user roles."
    example: "memberOf"
  - name: "AUTH_LDAP_ROLE_FILTER"
    description: "A search filter used to locate the roles associated with the authenticated user. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. The authenticated userDN is substituted into the filter anywhere a {1} is used. An example search filter that matches on the input username is (member={0}). An alternative that matches on the authenticated userDN is (member={1})."
    example: "(memberOf={1})"
  - name: "AUTH_LDAP_ROLE_RECURSION"
    description: "The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to 0."
    example: "1"
  - name: "AUTH_LDAP_ROLES_CTX_DN"
    description: "The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is."
    example: "ou=groups,ou=example,ou=com"
  - name: "AUTH_LDAP_SEARCH_TIME_LIMIT"
    description: "The timeout in milliseconds for user or role searches."
    example: "10000"
  - name: "AUTH_LDAP_URL"
    description: "LDAP endpoint to connect for authentication. For failover set two or more LDAP endpoints separated by space."
    example: "ldap://myldap.example.com:389"
  - name: "AUTH_LDAP_LOGIN_MODULE"
    description: "LDAP login module flag, adds backward compatibility with the legacy security subsystem on elytron. 'optional' is the only supported value, if set will create a distributed realm with ldap and filesystem realm with the user added using the KIE_ADMIN_USER."
    example: "optional"
  - name: "AUTH_LDAP_LOGIN_FAILOVER"
    description: "Enable failover, if Ldap Url is unreachable, it will fail over to the KieFsRealm."
    example: "true"
  - name: "LOGGER_PATTERN"
    example: "%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
    description: "Can be used to customize the out of the box log formatter delivered with the image. The default pattern is: %K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
